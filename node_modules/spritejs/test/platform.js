const test = require('ava')
const fs = require('fs')

function loadFile(src) {
  return new Promise((resolve, reject) => {
    fs.readFile(src, (err, data) => {
      if(err) reject(err)
      resolve(data)
    })
  })
}

import {createCanvas, loadImage, getContainer} from '../src/platform'

/* eslint-disable no-console */
test('createCanvas', (t) => {
  const canvas = createCanvas()
  t.is(canvas.width, 300)
  t.is(canvas.height, 150)
})

// https://s3.ssl.qhres.com/static/6357de62c1c630e1.svg

test('load image', async (t) => {
  const img = await loadImage('https://p0.ssl.qhimg.com/t01300d8189b2edf8ca.jpg')
  t.is(img.width, 700)
  t.is(img.height, 1075)

  const buff = await loadFile('./test/img/red-block-150.png')
  const img2 = await loadImage(buff)
  t.is(img2.width, 150)
  t.is(img2.height, 150)

  const img3 = await loadImage('./test/img/red-block-150.png')
  t.is(img3.width, 150)
  t.is(img3.height, 150)

  const base64Data = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMQAAADwCAYAAABfTcvQAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzNiNTU3My04MjE1LTRlZmMtOGE3Ny04NGFiOWM3ZThiYWQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkY3OTI0RTE0QzNEMTFFOEEwRjdBMkExRUQ2QzY3NzgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkY3OTI0RTA0QzNEMTFFOEEwRjdBMkExRUQ2QzY3NzgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3YWYyYjQ2MS0wYTM1LTRlZDQtYjdhMC05ZTliMzFkZWI0YTMiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDowN2U1MDQ1Yi05NGFmLTExN2ItYTBh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'
  const img4 = await loadImage(base64Data)
  t.is(img4.width, 196)
  t.is(img4.height, 240)
})

test('getContainer', (t) => {
  const container = getContainer('abc')
  t.is(container.id, 'abc')
  t.throws(() => {
    getContainer(null)
  })
})

test('event', (t) => {
  const container = getContainer('abc')
  let x = 0
  container.addEventListener('test', (evt) => {
    console.log(evt.msg, x)
    x++
  })
  container.addEventListener('test', (evt) => {
    console.log(evt.msg, x)
    x++
  })
  function listener(evt) {
    console.log(evt.msg, x)
    x++
  }
  container.addEventListener('test', listener)

  container.dispatchEvent({type: 'test', msg: 'event test triggered'})
  container.removeEventListener('test', listener)
  container.dispatchEvent({type: 'test', msg: 'event test triggered'})
  container.removeEventListener('test')
  container.dispatchEvent({type: 'test', msg: 'event test triggered'})
  t.is(x, 5)
})

test('appendChild', (t) => {
  const container = getContainer('abc')
  const a = {id: 'a'},
    b = {id: 'b'},
    c = {id: 'c'}

  container.appendChild(a)
  container.appendChild(b)
  t.deepEqual(container.children.map(o => o.id), ['a', 'b'])

  container.appendChild(a)
  t.deepEqual(container.children.map(o => o.id), ['b', 'a'])

  t.throws(() => container.insertBefore(a, c))
  container.insertBefore(c, b)
  t.deepEqual(container.children.map(o => o.id), ['c', 'b', 'a'])
})
/* eslint-enable no-console */
